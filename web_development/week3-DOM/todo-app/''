import "../styles/modern-normalize.css";
import "../styles/style.css";

// The State
const TODOS = ["foo", "bar"];

function OuterContainer(todos) {
  const outerContainer = document.createElement("section");

  const appName = document.createElement("h1");
  appName.innerText = "Simple Todo";
  outerContainer.classList.add("outer-container");

  outerContainer.appendChild(appName);
  outerContainer.appendChild(Input());
  outerContainer.appendChild(Todos(todos));
  return outerContainer;
}

function Input() {
  const inputContainer = document.createElement("section");
  inputContainer.classList.add("input-container");

  const inputField = document.createElement("input");
  inputField.type = "text";

  const addButton = document.createElement("button");
  addButton.innerText = "Add Todo";
  addButton.onclick = () => {
    TODOS.push(inputField.value);
    render(OuterContainer(TODOS));
  };

  const clearButton = document.createElement("button");
  clearButton.innerText = "Clear Todo";
  clearButton.onclick = () => {
    TODOS.length = 0;
    render(OuterContainer(TODOS));
  };

  inputContainer.appendChild(inputField);
  inputContainer.appendChild(addButton);
  inputContainer.appendChild(clearButton);

  return inputContainer;
}

function Todos(todos) {
  function Todo({ key, value }) {
    const todoItem = document.createElement("div");
    todoItem.id = `todoitem-${key}`;
    todoItem.classList.add("todo-item");

    const checkbox = document.createElement("input");
    checkbox.type = "checkbox";
    checkbox.classList.add("checkbox");
    checkbox.onclick = () => {
      render(OuterContainer(TODOS))
    }

    const input = document.createElement("input");
    input.value = value;
    input.disabled = true;
    input.classList.add("input-field");
    if (checkbox.checked) input.style.textDecoration = "line-through 3px";

    todoItem.appendChild(checkbox);
    todoItem.appendChild(input);
    return todoItem;
  }

  const todoContainer = document.createElement("section");
  todoContainer.classList.add("todo-container");
  todos.map((value, key) => {
    todoContainer.appendChild(Todo({ key, value }));
  });
  return todoContainer;
}

function render(component) {
  const root = document.getElementById("root");
  // Clear previous elements
  root.querySelectorAll("*").forEach((ele) => ele.remove());
  // re-render the whole thing
  root.appendChild(component);
  console.log(root);
}

render(OuterContainer(TODOS));
